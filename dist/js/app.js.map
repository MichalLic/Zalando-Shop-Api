{"version":3,"sources":["CartControler.js","ProductDetailsControler.js","script.js"],"names":["CartControl","$CART_BLOCK","$","init","Zalando","getPreviouslyPage","$BTN_PREV","drawCartDetail","onRemoveLocalStorageItem","removeAllItems","addProductToCart","data","quantity","getProductQuantity","productDetails","id","name","price","units","value","currency","img","media","images","thumbnailHdUrl","PRODUCTS_LOCAL_STORAGE","console","log","push","isInCart","each","index","item","localStorage","setItem","JSON","stringify","number","val","Number","block","map","html","emptyCartMessage","addRemovedButton","remove","getProductDetailToCart","ajax","url","URL","method","dataType","headers","Accept-Language","success","response","error","alert","onPutToCart","btn","on","e","preventDefault","getItem","replace","scrollToTop","ProductControl","showMessage","is","append","i","length","this","attr","removeItem","splice","refreshProductsCollection","$OWL_CAROUSEL","$CART_MODAL","getProductId","getProductDetail","window","location","hash","split","renderedMustacheProduct","template","Mustache","parse","rendered","render","renderedMustacheOwlCarousel","owlCarousel","owlRefresh","addClass","setTimeout","removeClass","items","singleItem","autoplay","autoplayHoverPause","dots","loop","margin","mouseDrag","nav","smartSpeed","navText","trigger","$PRODUCTS","$CATEGORY_LINK","$PRODUCTS_SECTION","PRODUCT_DETAIL","getProducts","onInitTrueFunction","isFilter","endpoint","filters","getSingleElement","returnFilteredDataUrl","param","dataset","content","product","renderedMustache","addedElement","elementPlace","history","back","animate","scrollTop"],"mappings":"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","file":"app.js","sourcesContent":["var CartControl = {\r\n    $CART_BLOCK: $('.cart-block'),\r\n\r\n    //Init\r\n    init: function () {\r\n        Zalando.getPreviouslyPage(Zalando.$BTN_PREV);\r\n        CartControl.drawCartDetail();\r\n        CartControl.onRemoveLocalStorageItem();\r\n        CartControl.removeAllItems();\r\n\r\n    },\r\n\r\n    //Functions\r\n    /**\r\n     * Function on subpage cart\r\n     */\r\n    addProductToCart: function (data) {\r\n        var quantity = CartControl.getProductQuantity();\r\n        var productDetails = {\r\n            id: data.id,\r\n            name: data.name,\r\n            price: data.units[0].price.value,\r\n            currency: 'Â£',\r\n            img: data.media.images[0].thumbnailHdUrl,\r\n            quantity: quantity\r\n        };\r\n\r\n        if (Zalando.PRODUCTS_LOCAL_STORAGE === '') {\r\n            console.log('dodaje pierwszy produkt do pustego koszyka');\r\n            Zalando.PRODUCTS_LOCAL_STORAGE.push(productDetails);\r\n        } else {\r\n            var isInCart = false;\r\n            $.each(Zalando.PRODUCTS_LOCAL_STORAGE, function (index, item) {\r\n                if (productDetails.id === item.id) {\r\n                    console.log('dodaje pierwszy lecz koszyk NIE BYL pusty');\r\n                    console.log('increment product quantity');\r\n                    item.quantity += quantity;\r\n                    isInCart = true;\r\n                }\r\n            });\r\n                if(isInCart === false) {\r\n                    console.log('dodaje produkt ktorego nie bylo w koszyku a on mial juz produkty');\r\n                    Zalando.PRODUCTS_LOCAL_STORAGE.push(productDetails);\r\n                }\r\n        }\r\n        localStorage.setItem('products', JSON.stringify(Zalando.PRODUCTS_LOCAL_STORAGE));\r\n        CartControl.drawCartDetail();\r\n    },\r\n\r\n    /**\r\n     * get integer value\r\n     * @returns {number}\r\n     */\r\n    getProductQuantity: function () {\r\n        var number = $('#quantity').val();\r\n        return Number(number);\r\n    },\r\n\r\n    /**\r\n     * Draw product detail in cart page\r\n     */\r\n    drawCartDetail: function () {\r\n        var block = '';\r\n        $.map(Zalando.PRODUCTS_LOCAL_STORAGE, function (item) {\r\n            block += '<div class=\"cart-product-detail\">';\r\n            block += '<span><a href=\"product.html#'+item.id+'\">'+item.name+'</a></span>';\r\n            block += '<span><b>' + item.currency + item.price*item.quantity + '</b></span>';\r\n            block += '<span><img src=\"' + item.img + '\"></span>';\r\n            block += '<span><b>QTY</b>:' + item.quantity + '</span>';\r\n            block += '<a href=\"#\" data-id=\"' + item.id + '\" class=\"btn-remove-item\"><i class=\"fa fa-times\" aria-hidden=\"true\"></i></a>';\r\n            block += '</div>';\r\n        });\r\n        CartControl.$CART_BLOCK.html(block);\r\n        CartControl.emptyCartMessage();\r\n        if (block !== '') {\r\n            CartControl.addRemovedButton();\r\n        } else {\r\n            $('.btn-remove-items').remove();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * get data and init first function\r\n     * @param id\r\n     */\r\n    getProductDetailToCart: function (id) {\r\n        $.ajax({\r\n            url: Zalando.URL + id,\r\n            method: 'get',\r\n            dataType: 'JSON',\r\n            headers: {\r\n                'Accept-Language': 'en'\r\n            },\r\n            success: function (response) {\r\n                CartControl.addProductToCart(response);\r\n            },\r\n            error: function () {\r\n                alert(\"Error getting data\");\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * put product to basket\r\n     * @param btn\r\n     */\r\n    onPutToCart: function (btn) {\r\n        btn.on('click', function (e) {\r\n            e.preventDefault();\r\n            var id = localStorage.getItem('id').replace(/['\"]+/g, '');\r\n            Zalando.scrollToTop();\r\n            ProductControl.showMessage();\r\n            CartControl.getProductDetailToCart(id);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * show message in case of empty basket\r\n     */\r\n    emptyCartMessage: function () {\r\n        if (CartControl.$CART_BLOCK.is(':empty')) {\r\n            CartControl.$CART_BLOCK.append('<p class=\"cart-message-empty\">Your basket is currently empty!</p>');\r\n        }\r\n    },\r\n\r\n    /**\r\n     * remove single item by using localStorage\r\n     */\r\n    onRemoveLocalStorageItem: function () {\r\n        CartControl.$CART_BLOCK.on('click', '.btn-remove-item', function (e) {\r\n            e.preventDefault();\r\n            for (var i = 0; i < Zalando.PRODUCTS_LOCAL_STORAGE.length; i++) {\r\n                if (Zalando.PRODUCTS_LOCAL_STORAGE[i].id === $(this).attr('data-id')) {\r\n                    localStorage.removeItem(Zalando.PRODUCTS_LOCAL_STORAGE.splice(i, 1));\r\n                    localStorage.setItem('products', JSON.stringify(Zalando.PRODUCTS_LOCAL_STORAGE));\r\n                    CartControl.drawCartDetail();\r\n                }\r\n            }\r\n        })\r\n    },\r\n\r\n    /**\r\n     * add button to html\r\n     */\r\n    addRemovedButton: function () {\r\n        var block = '<a href=\"#\" class=\"btn-remove-items\">Remove all</a>';\r\n        $('.remove-block').html(block);\r\n    },\r\n\r\n    /**\r\n     * remove all products by using localStorage\r\n     */\r\n    removeAllItems: function () {\r\n        $('main').on('click', '.btn-remove-items', function (e) {\r\n            e.preventDefault();\r\n            localStorage.setItem('products', JSON.stringify(''));\r\n            Zalando.refreshProductsCollection();\r\n            CartControl.drawCartDetail();\r\n        })\r\n    }\r\n\r\n\r\n};","var ProductControl = {\r\n    $OWL_CAROUSEL: $('.owl-carousel'),\r\n    $CART_MODAL: $('.cart-modal'),\r\n\r\n    //Init\r\n    init: function () {\r\n        var id = ProductControl.getProductId();\r\n        ProductControl.getProductDetail(id);\r\n        Zalando.getPreviouslyPage(Zalando.$BTN_PREV);\r\n    },\r\n\r\n    //Functions\r\n    /**\r\n     * Get product id by window.location.hash method\r\n     * @returns {*}\r\n     */\r\n    getProductId: function () {\r\n        var hash = window.location.hash;\r\n        var id = hash.split('#');\r\n        return id[1];\r\n    },\r\n\r\n    /**\r\n     * Draw product details\r\n     * @param data\r\n     */\r\n    renderedMustacheProduct: function (data) {\r\n        var template = $('#product-detail').html();\r\n        Mustache.parse(template);\r\n        var rendered = Mustache.render(template, data);\r\n        $('.product-detail').html(rendered);\r\n    },\r\n\r\n    /**\r\n     * Draw owl carousel\r\n     * @param data\r\n     */\r\n    renderedMustacheOwlCarousel: function (data) {\r\n        var template = $('#owl-carousel').html();\r\n        Mustache.parse(template);\r\n        var rendered = Mustache.render(template, data);\r\n        $('#owl-product').append(rendered);\r\n    },\r\n\r\n    /**\r\n     * Get products from proper url\r\n     */\r\n    getProductDetail: function (id) {\r\n        $.ajax({\r\n            url: Zalando.URL + id,\r\n            method: 'get',\r\n            dataType: 'JSON',\r\n            headers: {\r\n                'Accept-Language': 'en'\r\n            },\r\n            success: function (response) {\r\n                console.log(response);\r\n                ProductControl.renderedMustacheProduct(response);\r\n                ProductControl.renderedMustacheOwlCarousel(response);\r\n                localStorage.setItem('id', JSON.stringify(response.id));\r\n                ProductControl.owlCarousel();\r\n                ProductControl.owlRefresh();\r\n\r\n                //Init cart page functions\r\n                CartControl.drawCartDetail();\r\n                CartControl.onPutToCart($('.add-link'));\r\n            },\r\n            error: function () {\r\n                alert(\"Error getting data\");\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * show message after add product to basket\r\n     */\r\n    showMessage: function () {\r\n        ProductControl.$CART_MODAL.addClass('show');\r\n\r\n        setTimeout(function () {\r\n            ProductControl.$CART_MODAL.removeClass('show');\r\n            }, 4000);\r\n    },\r\n\r\n    /**\r\n     * Init carousel and properties\r\n     */\r\n    owlCarousel: function () {\r\n        ProductControl.$OWL_CAROUSEL.owlCarousel({\r\n            items: 1,\r\n            singleItem: true,\r\n            autoplay: true,\r\n            autoplayHoverPause: true,\r\n            dots: false,\r\n            loop: true,\r\n            margin: 10,\r\n            mouseDrag: true,\r\n            nav: true,\r\n            smartSpeed: 1000,\r\n            navText: ['<i class=\"fa fa-chevron-left\" aria-hidden=\"true\"></i>',\r\n                '<i class=\"fa fa-chevron-right\" aria-hidden=\"true\"></i>']\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Refresh owl after loaded\r\n     */\r\n    owlRefresh: function () {\r\n        ProductControl.$OWL_CAROUSEL.trigger('refresh.owl.carousel');\r\n    }\r\n\r\n};","var Zalando = {\r\n    //variables\r\n    URL: 'https://api.zalando.com/articles/',\r\n    $PRODUCTS: $('#products'),\r\n    $CATEGORY_LINK: $('.category-link'),\r\n    $PRODUCTS_SECTION: $('.products-section'),\r\n    PRODUCT_DETAIL: 'product-detail',\r\n    $BTN_PREV: $('.btn-prev'),\r\n    PRODUCTS_LOCAL_STORAGE: JSON.parse(localStorage.getItem('products')) || [],\r\n\r\n    //Init\r\n    init: function () {\r\n        Zalando.getProducts(false);\r\n        Zalando.onInitTrueFunction(Zalando.$CATEGORY_LINK);\r\n    },\r\n\r\n    //Function\r\n    /**\r\n     * get products from proper url\r\n     * @param isFilter\r\n     * @param endpoint\r\n     */\r\n    getProducts: function (isFilter, endpoint) {\r\n        var filters = (isFilter === true) ? endpoint : \"\";\r\n        $.ajax({\r\n            url: Zalando.URL + filters,\r\n            method: 'get',\r\n            dataType: 'JSON',\r\n            headers: {\r\n                'Accept-Language': 'en'\r\n            },\r\n            success: function (response) {\r\n                console.log(response);\r\n                $('.product-link').remove();\r\n                Zalando.getSingleElement(response);\r\n            },\r\n            error: function () {\r\n                alert(\"Error getting data\")\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Init function when is true (have extra endpoint)\r\n     * @param btn\r\n     */\r\n    onInitTrueFunction: function (btn) {\r\n        btn.on('click', function (e) {\r\n            e.preventDefault();\r\n            Zalando.getProducts(true, Zalando.returnFilteredDataUrl(this));\r\n        })\r\n    },\r\n\r\n    /**\r\n     * Create proper endpoint by 'param' and 'dataset' functions\r\n     * @param btn\r\n     * @returns {string}\r\n     */\r\n    returnFilteredDataUrl: function (btn) {\r\n        return '?' + $.param(btn.dataset);\r\n    },\r\n\r\n    /**\r\n     * Get single product after map function\r\n     * @param data\r\n     */\r\n    getSingleElement: function (data) {\r\n        $.map(data.content, function (product) {\r\n            Zalando.renderedMustache(product, Zalando.$PRODUCTS, Zalando.$PRODUCTS_SECTION)\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Draw products on page content by mustache\r\n     * @param data\r\n     */\r\n    renderedMustache: function (data, addedElement, elementPlace) {\r\n        var template = addedElement.html();\r\n        Mustache.parse(template);\r\n        var rendered = Mustache.render(template, data);\r\n        elementPlace.append(rendered);\r\n    },\r\n\r\n    /**\r\n     * Back to previously page\r\n     * @param btn\r\n     */\r\n    getPreviouslyPage: function (btn) {\r\n        btn.on('click', function () {\r\n            window.history.back();\r\n        })\r\n    },\r\n\r\n    /**\r\n     * Scroll page to top\r\n     */\r\n    scrollToTop: function () {\r\n        $(\"html, body\").animate({scrollTop: 0}, \"slow\");\r\n    },\r\n\r\n    refreshProductsCollection: function () {\r\n        Zalando.PRODUCTS_LOCAL_STORAGE = JSON.parse(localStorage.getItem('products'));\r\n    }\r\n};"]}